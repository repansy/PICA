# 关于新方法model的说明

### **1. 研究动机：ORCA类算法在异构场景中的根本性局限**

ORCA原来的问题：
- 不适用非对称性的无人机集群，在无人机的避让责任分配问题上不合理
- 没有考虑运动交互过程中，因异质无人机的运动能力和策略不同，所需的运动空间规划不同
- 由于是反应式算法,在运动时感知中容错很低，容易引发碰撞



### **2. 核心思想：一个混合、分层决策框架**

我们最核心的创新就一点：我们设计了一个‘混合优化器’，来自动计算每个智能体应该承担多少规避责任（Alpha值），而这个计算是非对称的、考虑物理特性的、并且能应对不确定性的。该优化器由两个并行且互补的决策引擎构成，并由一个风险仲裁器动态协调：

##### **2.1 混合优化器 (核心创新)**

*   **A. 启发式引擎（"快脑" - Heuristic Engine）**：

    基于“环境压力越大、自身能力越强、任务越不重要，责任越大”的直觉。定义“责任分数” 
    $$S_i = (w_\rho \rho_i + w_M \text{tr}(\mathbf{M}_i^{-1})) / (w_P P_i)$$
    其中，$w_i$是各个参数的权重，$P$是无人机任务的权限，$\rho_i$是局部拥挤度的衡量，用大创原本的方案，M是原本方向矩阵W方案的改进，惯性矩阵的迹的倒数 $tr(M_i^{-1})$，用于量化机动性。$i$承担的责任为其分数占比：
    $$\alpha_{h,i} = \frac{S_i}{S_i + S_j}$$

*   **B. 解析法引擎 （"慢脑" - Analytical Engine）**
    通过最小化一个联合的**物理运动代价**函数 $C(\alpha_i)$ 来求解理论最优责任。
    1.  **代价函数**:
        $$
        C(\alpha_i) = \Sigma_{i=0}^{i=n} \rho_i ||\mathbf{v}'_i(\alpha_i) - \mathbf{v}_{\text{pref},i}||^2_{\mathbf{M}_i}
        $$
        其中 $||\mathbf{x}||^2_\mathbf{M} = \mathbf{x}^T \mathbf{M} \mathbf{x}$ 代表真实的运动学代价。

    2.  **动力学线性化**: 假设在一个小的时间步内，规避速度 $\mathbf{v}'_k$ 与其责任 $\alpha_k$ 呈线性关系：$\mathbf{v}'_k(\alpha_k) \approx \mathbf{a}_k \alpha_k + \mathbf{b}_k$。向量 $\mathbf{a}_k, \mathbf{b}_k$ 可通过对ORCA求解器进行一次数值微分高效求得。

    3.  **解析解**: 将线性模型代入代价函数，得到一个关于 $\alpha_i$ 的二次函数 $C(\alpha_i) \approx K_1 \alpha_i^2 + K_2 \alpha_i + K_3$。其最小值点可通过令导数为零求得：
        $$
        \alpha_{a,i} = -\frac{K_2}{2K_1}
        $$

*   **C. 风险加权融合 (Risk-Weighted Blending)**
    根据距离风险 + 碰撞时间风险（越短风险越高）计算的风险评分 `Risk`，通过权重 $w = f(\text{Risk})$ 对两个引擎的结果进行线性插值，得到最终的责任参数 $\alpha_{\text{final},i}$。

##### **2.2 概率与物理状态的建模**

为支撑上述优化器，我们对智能体状态进行了两层抽象：

1.  **概率状态层**：我们将每个智能体 `i` 的位置和速度建模为高斯分布 $\mathbf{p}_i \sim \mathcal{N}(\boldsymbol{\mu}_{p_i}, \mathbf{\Sigma}_{p_i})$。为了应用确定性几何，我们首先计算一个保守的**有效位置** $\mathbf{p}_{\text{eff},i}$，该位置为不确定性预留了安全边际。
   
2.  **物理语义层**：将智能体的异构性抽象为两个核心语义参数：
    *   **任务优先级 `P`**：一个标量，量化任务的重要性。
    *   **惯性矩阵 `M`**：一个矩阵，量化智能体在不同方向上改变运动状态的“难度”（e.g., 对于敏捷的四旋翼，$\mathbf{M} \approx m\mathbf{I}$；对于固定翼，惩罚侧向/垂向速度变化的非对角线项会很大）同时，以M导向引入AVO方法，既解决了在运动轨迹场景的不自然性，同时避免了在无人机集群场景下原来AVO、GRCA方法繁杂的运算和建模。
